player_data |> arrange(desc(predicted_2026_points)) |> filter(short_name == "MCI" & element_type ==1) |> relocate(predicted_2026_points, clean_sheets_predict, minutes_any_weighted, minutes_60_weighted)|> print(n=100)
player_data |> arrange(desc(predicted_2026_points)) |> filter(short_name == "MCI" & element_type ==1) |> relocate(predicted_2026_points, clean_sheets_predict_2026, play_predict_2026, concede_2_predict_2026, concede_4_predict_2026)|> print(n=100)
#| label: export_player_points
write_csv(player_data,"processed_data/player_data.csv")
player_data <- read_csv("processed_data/player_data.csv")
#|label: import-points-predictions
library(tidyverse)
library(tidymodels)
player_data <- read_csv("processed_data/player_data.csv")
player_data <- read_csv("processed_data/player_data.csv")
#| label: team-functions
dummy_team <- player_data |>
team_checker <- function(team) {
is_15 <- nrow(team) == 15
is_2_GK <- nrow(team |> filter (element_type == 1)) == 2
is_5_DF <- nrow(team |> filter (element_type == 2)) == 5
is_5_MD <- nrow(team |> filter (element_type == 3)) == 5
is_3_FW <- nrow(team |> filter (element_type == 4)) == 3
all(is_15, is_2_GK, is_5_DF, is_5_MD, is_3_FW)
}
player_data
#| label: team-functions
example_team <- player_data |> filter(
web_name %in% c(
"Pickford",
"Sels",
"Gvardiol",
"Murillo",
"Mings",
"Pinnock",
"O'Brien",
"M.Salah",
"Joelinton",
"Rogers",
"J.Murphy",
"Kluivert",
"Bowen",
"Wissa",
"Mateta"
)
)
example_team
#| label: team-functions
example_team <- player_data |> filter(
web_name %in% c(
"Pickford",
"Sels",
"Gvardiol",
"Murillo",
"Mings",
"Pinnock",
"Aina",
"M.Salah",
"Joelinton",
"Rogers",
"J.Murphy",
"Kluivert",
"Bowen",
"Wissa",
"Mateta"
)
)
example_team
team_checker(example_team)
team_checker <- function(team) {
is_15 <- nrow(team) == 15
is_2_GK <- nrow(team |> filter (element_type == 1)) == 2
is_5_DF <- nrow(team |> filter (element_type == 2)) == 5
is_5_MD <- nrow(team |> filter (element_type == 3)) == 5
is_3_FW <- nrow(team |> filter (element_type == 4)) == 3
all(is_15, is_2_GK, is_5_DF, is_5_MD, is_3_FW)
}
team_checker(example_team)
#| label: team-functions
example_team <- player_data |> filter(
web_name %in% c(
"Pickford",
"Sels",
"Gvardiol",
"Murillo",
"Mings",
"Pinnock",
"Aina",
"M.Salah",
"Joelinton",
"Rogers",
"J.Murphy",
"Kluivert",
"Bowen",
"Wood",
"Mateta"
)
)
team_checker <- function(team) {
is_15 <- nrow(team) == 15
is_2_GK <- nrow(team |> filter (element_type == 1)) == 2
is_5_DF <- nrow(team |> filter (element_type == 2)) == 5
is_5_MD <- nrow(team |> filter (element_type == 3)) == 5
is_3_FW <- nrow(team |> filter (element_type == 4)) == 3
all(is_15, is_2_GK, is_5_DF, is_5_MD, is_3_FW)
}
team_checker(example_team)
#| label: team-functions
example_team <- player_data |> filter(
web_name %in% c(
"Pickford",
"Sels",
"Gvardiol",
"Murillo",
"Mings",
"Pinnock",
"Wood",
"M.Salah",
"Joelinton",
"Rogers",
"J.Murphy",
"Kluivert",
"Bowen",
"Wissa",
"Mateta"
)
)
team_checker <- function(team) {
is_15 <- nrow(team) == 15
is_2_GK <- nrow(team |> filter (element_type == 1)) == 2
is_5_DF <- nrow(team |> filter (element_type == 2)) == 5
is_5_MD <- nrow(team |> filter (element_type == 3)) == 5
is_3_FW <- nrow(team |> filter (element_type == 4)) == 3
all(is_15, is_2_GK, is_5_DF, is_5_MD, is_3_FW)
}
team_checker(example_team)
example_team
?summarise
?head
max_three_per_team <- head(count(team, short_name, sort = TRUE)|>select(n))<=3
team_checker <- function(team) {
is_15 <- nrow(team) == 15
is_2_GK <- nrow(team |> filter (element_type == 1)) == 2
is_5_DF <- nrow(team |> filter (element_type == 2)) == 5
is_5_MD <- nrow(team |> filter (element_type == 3)) == 5
is_3_FW <- nrow(team |> filter (element_type == 4)) == 3
max_three_per_team <- head(count(team, short_name, sort = TRUE)|>select(n))<=3
all(is_15, is_2_GK, is_5_DF, is_5_MD, is_3_FW, max_three_per_team)
}
team_checker(example_team)
max_three_per_team
team_checker <- function(team) {
is_15 <- nrow(team) == 15
is_2_GK <- nrow(team |> filter (element_type == 1)) == 2
is_5_DF <- nrow(team |> filter (element_type == 2)) == 5
is_5_MD <- nrow(team |> filter (element_type == 3)) == 5
is_3_FW <- nrow(team |> filter (element_type == 4)) == 3
max_three_per_team <- head(count(team, short_name, sort = TRUE)|>select(n))<=3
max_three_per_team
all(is_15, is_2_GK, is_5_DF, is_5_MD, is_3_FW, max_three_per_team)
}
team_checker(example_team)
team_checker <- function(team) {
is_15 <- nrow(team) == 15
is_2_GK <- nrow(team |> filter (element_type == 1)) == 2
is_5_DF <- nrow(team |> filter (element_type == 2)) == 5
is_5_MD <- nrow(team |> filter (element_type == 3)) == 5
is_3_FW <- nrow(team |> filter (element_type == 4)) == 3
max_three_per_team <- head(count(team, short_name, sort = TRUE)|>select(n))<=3
max_three_per_team
# all(is_15, is_2_GK, is_5_DF, is_5_MD, is_3_FW, max_three_per_team)
}
team_checker(example_team)
team_checker <- function(team) {
is_15 <- nrow(team) == 15
is_2_GK <- nrow(team |> filter (element_type == 1)) == 2
is_5_DF <- nrow(team |> filter (element_type == 2)) == 5
is_5_MD <- nrow(team |> filter (element_type == 3)) == 5
is_3_FW <- nrow(team |> filter (element_type == 4)) == 3
max_three_per_team <- max(count(team, short_name, sort = TRUE))<=3
max_three_per_team
# all(is_15, is_2_GK, is_5_DF, is_5_MD, is_3_FW, max_three_per_team)
}
team_checker(example_team)
team_checker <- function(team) {
is_15 <- nrow(team) == 15
is_2_GK <- nrow(team |> filter (element_type == 1)) == 2
is_5_DF <- nrow(team |> filter (element_type == 2)) == 5
is_5_MD <- nrow(team |> filter (element_type == 3)) == 5
is_3_FW <- nrow(team |> filter (element_type == 4)) == 3
max_three_per_team <- count(team, short_name, sort = TRUE)
max_three_per_team
# all(is_15, is_2_GK, is_5_DF, is_5_MD, is_3_FW, max_three_per_team)
}
team_checker(example_team)
team_checker <- function(team) {
is_15 <- nrow(team) == 15
is_2_GK <- nrow(team |> filter (element_type == 1)) == 2
is_5_DF <- nrow(team |> filter (element_type == 2)) == 5
is_5_MD <- nrow(team |> filter (element_type == 3)) == 5
is_3_FW <- nrow(team |> filter (element_type == 4)) == 3
teams_with_over_3 <- count(team, short_name, sort = TRUE) |>
filter(n > 3)
max_three_per_team <- nrow(teams_with_over_3 == 0)
all(is_15, is_2_GK, is_5_DF, is_5_MD, is_3_FW, max_three_per_team)
}
team_checker(example_team)
team_checker <- function(team) {
is_15 <- nrow(team) == 15
is_2_GK <- nrow(team |> filter (element_type == 1)) == 2
is_5_DF <- nrow(team |> filter (element_type == 2)) == 5
is_5_MD <- nrow(team |> filter (element_type == 3)) == 5
is_3_FW <- nrow(team |> filter (element_type == 4)) == 3
teams_with_over_3 <- count(team, short_name, sort = TRUE) |>
filter(n > 3)
teams_with_over_3
# max_three_per_team <- nrow(teams_with_over_3 == 0)
# all(is_15, is_2_GK, is_5_DF, is_5_MD, is_3_FW, max_three_per_team)
}
team_checker(example_team)
max_three_per_team
team_checker <- function(team) {
is_15 <- nrow(team) == 15
is_2_GK <- nrow(team |> filter (element_type == 1)) == 2
is_5_DF <- nrow(team |> filter (element_type == 2)) == 5
is_5_MD <- nrow(team |> filter (element_type == 3)) == 5
is_3_FW <- nrow(team |> filter (element_type == 4)) == 3
teams_with_over_3 <- count(team, short_name, sort = TRUE) |>
filter(n > 3)
max_three_per_team <- nrow(teams_with_over_3 == 0)
max_three_per_team
# all(is_15, is_2_GK, is_5_DF, is_5_MD, is_3_FW, max_three_per_team)
}
team_checker(example_team)
max_three_per_team <- nrow(teams_with_over_3) == 0
team_checker <- function(team) {
is_15 <- nrow(team) == 15
is_2_GK <- nrow(team |> filter (element_type == 1)) == 2
is_5_DF <- nrow(team |> filter (element_type == 2)) == 5
is_5_MD <- nrow(team |> filter (element_type == 3)) == 5
is_3_FW <- nrow(team |> filter (element_type == 4)) == 3
teams_with_over_3 <- count(team, short_name, sort = TRUE) |>
filter(n > 3)
max_three_per_team <- nrow(teams_with_over_3) == 0
max_three_per_team
# all(is_15, is_2_GK, is_5_DF, is_5_MD, is_3_FW, max_three_per_team)
}
team_checker(example_team)
team_checker <- function(team) {
is_15 <- nrow(team) == 15
is_2_GK <- nrow(team |> filter (element_type == 1)) == 2
is_5_DF <- nrow(team |> filter (element_type == 2)) == 5
is_5_MD <- nrow(team |> filter (element_type == 3)) == 5
is_3_FW <- nrow(team |> filter (element_type == 4)) == 3
teams_with_over_3 <- count(team, short_name, sort = TRUE) |>
filter(n > 3)
max_three_per_team <- nrow(teams_with_over_3) == 0
all(is_15, is_2_GK, is_5_DF, is_5_MD, is_3_FW, max_three_per_team)
}
team_checker(example_team)
nrow(teams_with_over_3)
team_checker <- function(team) {
is_15 <- nrow(team) == 15
is_2_GK <- nrow(team |> filter (element_type == 1)) == 2
is_5_DF <- nrow(team |> filter (element_type == 2)) == 5
is_5_MD <- nrow(team |> filter (element_type == 3)) == 5
is_3_FW <- nrow(team |> filter (element_type == 4)) == 3
teams_with_over_3 <- count(team, short_name, sort = TRUE) |>
filter(n > 3)
max_three_per_team <- nrow(teams_with_over_3) == 0
nrow(teams_with_over_3)
# all(is_15, is_2_GK, is_5_DF, is_5_MD, is_3_FW, max_three_per_team)
}
team_checker(example_team)
team_checker <- function(team) {
is_15 <- nrow(team) == 15
is_2_GK <- nrow(team |> filter (element_type == 1)) == 2
is_5_DF <- nrow(team |> filter (element_type == 2)) == 5
is_5_MD <- nrow(team |> filter (element_type == 3)) == 5
is_3_FW <- nrow(team |> filter (element_type == 4)) == 3
teams_with_over_3 <- count(team, short_name, sort = TRUE) |>
filter(n > 3)
max_three_per_team <- nrow(teams_with_over_3) == 0
max_three_per_team
# all(is_15, is_2_GK, is_5_DF, is_5_MD, is_3_FW, max_three_per_team)
}
team_checker(example_team)
team_checker <- function(team) {
is_15 <- nrow(team) == 15
is_2_GK <- nrow(team |> filter (element_type == 1)) == 2
is_5_DF <- nrow(team |> filter (element_type == 2)) == 5
is_5_MD <- nrow(team |> filter (element_type == 3)) == 5
is_3_FW <- nrow(team |> filter (element_type == 4)) == 3
teams_with_over_3 <- count(team, short_name, sort = TRUE) |>
filter(n > 3)
max_three_per_team <- nrow(teams_with_over_3) == 0
all(is_15, is_2_GK, is_5_DF, is_5_MD, is_3_FW, max_three_per_team)
}
team_checker(example_team)
team_checker <- function(team) {
is_15 <- nrow(team) == 15
is_2_GK <- nrow(team |> filter (element_type == 1)) == 2
is_5_DF <- nrow(team |> filter (element_type == 2)) == 5
is_5_MD <- nrow(team |> filter (element_type == 3)) == 5
is_3_FW <- nrow(team |> filter (element_type == 4)) == 3
teams_with_over_3 <- count(team, short_name, sort = TRUE) |>
filter(n > 3)
max_three_per_team <- nrow(teams_with_over_3) == 0
c(is_15, is_2_GK, is_5_DF, is_5_MD, is_3_FW, max_three_per_team)
}
team_checker(example_team)
#| label: team-functions
example_team <- player_data |> filter(
web_name %in% c(
"Pickford",
"Sels",
"Gvardiol",
"Murillo",
"Mings",
"Pinnock",
"Aina",
"M.Salah",
"Joelinton",
"Rogers",
"J.Murphy",
"Kluivert",
"Bowen",
"Wissa",
"Mateta"
)
)
team_checker <- function(team) {
is_15 <- nrow(team) == 15
is_2_GK <- nrow(team |> filter (element_type == 1)) == 2
is_5_DF <- nrow(team |> filter (element_type == 2)) == 5
is_5_MD <- nrow(team |> filter (element_type == 3)) == 5
is_3_FW <- nrow(team |> filter (element_type == 4)) == 3
teams_with_over_3 <- count(team, short_name, sort = TRUE) |>
filter(n > 3)
max_three_per_team <- nrow(teams_with_over_3) == 0
c(is_15, is_2_GK, is_5_DF, is_5_MD, is_3_FW, max_three_per_team)
}
team_checker(example_team)
team_checker <- function(team) {
is_15 <- nrow(team) == 15
is_2_GK <- nrow(team |> filter (element_type == 1)) == 2
is_5_DF <- nrow(team |> filter (element_type == 2)) == 5
is_5_MD <- nrow(team |> filter (element_type == 3)) == 5
is_3_FW <- nrow(team |> filter (element_type == 4)) == 3
teams_with_over_3 <- count(team, short_name, sort = TRUE) |>
filter(n > 3)
max_three_per_team <- nrow(teams_with_over_3) == 0
all(is_15, is_2_GK, is_5_DF, is_5_MD, is_3_FW, max_three_per_team)
}
team_checker(example_team)
#| label: team-functions
example_team <- player_data |> filter(
web_name %in% c(
"Pickford",
"Sels",
"Gvardiol",
"Murillo",
"Mings",
"Pinnock",
"Aina",
"M.Salah",
"Joelinton",
"Rogers",
"J.Murphy",
"Kluivert",
"Bowen",
"Wood",
"Mateta"
)
)
team_checker <- function(team) {
is_15 <- nrow(team) == 15
is_2_GK <- nrow(team |> filter (element_type == 1)) == 2
is_5_DF <- nrow(team |> filter (element_type == 2)) == 5
is_5_MD <- nrow(team |> filter (element_type == 3)) == 5
is_3_FW <- nrow(team |> filter (element_type == 4)) == 3
teams_with_over_3 <- count(team, short_name, sort = TRUE) |>
filter(n > 3)
max_three_per_team <- nrow(teams_with_over_3) == 0
all(is_15, is_2_GK, is_5_DF, is_5_MD, is_3_FW, max_three_per_team)
}
team_checker(example_team)
team_checker <- function(team) {
is_15 <- nrow(team) == 15
is_2_GK <- nrow(team |> filter (element_type == 1)) == 2
is_5_DF <- nrow(team |> filter (element_type == 2)) == 5
is_5_MD <- nrow(team |> filter (element_type == 3)) == 5
is_3_FW <- nrow(team |> filter (element_type == 4)) == 3
teams_with_over_3 <- count(team, short_name, sort = TRUE) |>
filter(n > 3)
max_three_per_team <- nrow(teams_with_over_3) == 0
c(is_15, is_2_GK, is_5_DF, is_5_MD, is_3_FW, max_three_per_team)
}
team_checker(example_team)
team_checker <- function(team) {
is_15 <- nrow(team) == 15
is_2_GK <- nrow(team |> filter (element_type == 1)) == 2
is_5_DF <- nrow(team |> filter (element_type == 2)) == 5
is_5_MD <- nrow(team |> filter (element_type == 3)) == 5
is_3_FW <- nrow(team |> filter (element_type == 4)) == 3
teams_with_over_3 <- count(team, short_name, sort = TRUE) |>
filter(n > 3)
max_three_per_team <- nrow(teams_with_over_3) == 0
all(is_15, is_2_GK, is_5_DF, is_5_MD, is_3_FW, max_three_per_team)
}
team_checker(example_team)
example_team
team_cost <- function(team) {
team |> sum(now_cost)
}
team_cost(example_team)
example_team
team_cost <- function(team) {
team |> sum([[now_cost]])
team_cost <- function(team) {
team |> sum([now_cost])
sum(example_team, now_cost)
team_cost <- function(team) {
team |> summarise(total = sum(now_cost, na.rm = TRUE)) |> pull(total)
}
team_cost(example_team)
example_team|>
arrange(desc(score)) |>
arrange(element)
example_team
#organise to be in the right order for weighting
team <- team|>
arrange(desc(predicted_2026_points)) |>
arrange(element)
example_team|>
arrange(desc(predicted_2026_points)) |>
arrange(element)
example_team|>
arrange(desc(predicted_2026_points)) |>
arrange(element_type)
team_score <- function(team) {
# Set out likely weights for play time (can optimise later)
weights <- tribble(
~weight, 0.7, 0.3, 1, 1, 0.7, 0.7, 0.6, 1.5, 1.3, 1, 0.6, 0.4, 1.2, 0.6, 0.4
)
#organise to be in the right order for weighting
team <- team|>
arrange(desc(predicted_2026_points)) |>
arrange(element_type) |>
# then weight according to likely play time and captaincy and sum
cbind(weights)|>
mutate(weighted_score = predicted_2026_points * weights) |>
summarise(total = sum(weighted_score))|>
pull()
}
team_score(example_team)
example_team
team_score <- function(team) {
# Set out likely weights for play time (can optimise later)
weights <- tribble(
~weight, 0.7, 0.3, 1, 1, 0.7, 0.7, 0.6, 1.5, 1.3, 1, 0.6, 0.4, 1.2, 0.6, 0.4
)
#organise to be in the right order for weighting
team|>
arrange(desc(predicted_2026_points)) |>
arrange(element_type) |>
# then weight according to likely play time and captaincy and sum
cbind(weights)|>
mutate(weighted_score = predicted_2026_points * weights) |>
summarise(total = sum(weighted_score))|>
pull()
}
team_score(example_team)
#| label: team-functions
example_team <- player_data |> filter(
web_name %in% c(
"Pickford",
"Sels",
"Gvardiol",
"Murillo",
"Mings",
"Pinnock",
"Aina",
"Maddison",
"Joelinton",
"Rogers",
"J.Murphy",
"Kluivert",
"Bowen",
"Wissa",
"Mateta"
)
)
team_checker(example_team)
team_cost(example_team)
team_score(example_team)
#| label: team-functions
example_team <- player_data |> filter(
web_name %in% c(
"Pickford",
"Sels",
"Gvardiol",
"Murillo",
"Mings",
"Pinnock",
"Aina",
"M.Salah",
"Joelinton",
"Rogers",
"J.Murphy",
"Kluivert",
"Bowen",
"Wissa",
"Mateta"
)
)
q()
